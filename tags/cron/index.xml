<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cron on わいがかいた</title>
    <link>https://pyonk.github.io/blog/tags/cron/</link>
    <description>Recent content in Cron on わいがかいた</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <copyright>pyonk</copyright>
    <lastBuildDate>Mon, 06 Feb 2017 12:28:58 +0900</lastBuildDate>
    <atom:link href="https://pyonk.github.io/blog/tags/cron/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>crontab -e と /etc/crontab の違い</title>
      <link>https://pyonk.github.io/blog/post/difference-of-crontabe-and-etc-crontab/</link>
      <pubDate>Mon, 06 Feb 2017 12:28:58 +0900</pubDate>
      
      <guid>https://pyonk.github.io/blog/post/difference-of-crontabe-and-etc-crontab/</guid>
      <description>

&lt;p&gt;ふとした拍子にcronのログを見ていたら同じコマンドが実行されていたんですね。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ less /var/log/cron
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;Feb  6 00:15:01 ip-000-00-00-000 CROND[16356]: (user) CMD (python /home/user/app/manage.py hogehoge)
Feb  6 00:15:01 ip-000-00-00-000 CROND[16357]: (user) CMD (user python /home/user/app/manage.py hogehoge)
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;おかしいな-おかしいな&#34;&gt;おかしいな〜おかしいな〜〜〜〜〜&lt;/h1&gt;

&lt;p&gt;こわいな〜こわいな〜〜〜〜。&lt;/p&gt;

&lt;p&gt;何て思っていたんですが、そういえばcronの設定を二回したような気がしてきたので確かめてみました。&lt;/p&gt;

&lt;h2 id=&#34;etc-crontab&#34;&gt;/etc/crontab&lt;/h2&gt;

&lt;p&gt;まず初めにcronを設定したときはこのこをいじっていました。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ sudo vim /etc/crontab
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ですね。&lt;/p&gt;

&lt;h2 id=&#34;crontab-e&#34;&gt;crontab -e&lt;/h2&gt;

&lt;p&gt;何を思ったのかこっちでも設定していたような気がしました。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ crontab -l
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;で確認することができます。&lt;/p&gt;

&lt;p&gt;案の定同じコマンドが同じ時間で実行されるように設定されておりました。&lt;/p&gt;

&lt;h2 id=&#34;この二つの違いはなんなんでしょうか&#34;&gt;この二つの違いはなんなんでしょうか&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;http://superuser.com/questions/290093/difference-between-etc-crontab-and-crontab-e&#34;&gt;こちら&lt;/a&gt;がわかりやすいかと思います。&lt;/p&gt;

&lt;p&gt;要するに、
&lt;code&gt;/etc/crontab&lt;/code&gt;は他のユーザーのcronもまとめて設定できるようなのですね。&lt;/p&gt;

&lt;p&gt;たとえば&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* * * * * user echo &#39;fugafuga&#39;
* * * * * user2 echo &#39;hogehoge&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;のような感じです。&lt;/p&gt;

&lt;p&gt;対して、&lt;code&gt;crontab -e&lt;/code&gt;だと、今現在のユーザーのcronが設定できます。
オプションとして&lt;code&gt;-u&lt;/code&gt;を指定すると指定されたユーザーのcronが設定できるようです。&lt;/p&gt;

&lt;p&gt;&lt;code&gt;/etc/crontab&lt;/code&gt;と&lt;code&gt;crontab -e&lt;/code&gt;は別物なんですね。&lt;/p&gt;

&lt;p&gt;さっきの例だと&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ sudo vim /etc/crontab
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;* * * * * user echo &#39;fugafuga&#39;
* * * * * user2 echo &#39;hogehoge&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;とするのと&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ crontab -e -u user
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;* * * * * echo &#39;fugafuga&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;とするのと別のコマンドとして実行されるということです。&lt;/p&gt;

&lt;p&gt;ややこしいですね〜〜。&lt;/p&gt;

&lt;h1 id=&#34;最後に&#34;&gt;最後に&lt;/h1&gt;

&lt;p&gt;&lt;code&gt;-e&lt;/code&gt;と&lt;code&gt;-r&lt;/code&gt;を間違えないようにしたいですね。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ crontab -r
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;crontabの設定全部消えちゃいます。&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>