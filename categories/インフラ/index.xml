<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>インフラ on pyonk Blog</title>
    <link>http://pyonk.github.io/categories/%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9/</link>
    <description>Recent content in インフラ on pyonk Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <lastBuildDate>Fri, 15 Jul 2016 15:28:45 +0900</lastBuildDate>
    <atom:link href="http://pyonk.github.io/categories/%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>nginxのimage_filterを使って画像を動的に縮小するには</title>
      <link>http://pyonk.github.io/post/nginx-image-filter/</link>
      <pubDate>Fri, 15 Jul 2016 15:28:45 +0900</pubDate>
      
      <guid>http://pyonk.github.io/post/nginx-image-filter/</guid>
      <description>

&lt;h1 id=&#34;image-filterを使えるようにモジュールを指定する:a60d664650339cdda3703b53d8a6160d&#34;&gt;image_filterを使えるようにモジュールを指定する&lt;/h1&gt;

&lt;p&gt;nginxをソースからインストールする際に&lt;code&gt;--with-http_image_filter_module&lt;/code&gt;をつけてインストールします。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ wget http://nginx.org/download/nginx-1.10.1.tar.gz
$ tar -xvzf nginx-1.10.1.tar.gz
$ cd nginx-1.10.1
$ ./configure --with-http_image_filter_module
$ make
$ sudo make install
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ほかのオプションモジュールをつける場合は随時つけてください。&lt;/p&gt;

&lt;p&gt;すでにnginxがインストールされている場合は、&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ sudo cp objs/nginx /usr/sbin/nginx
$ cat /var/run/nginx.pid
10576
$ sudo kill -USR2 10576
$ sudo kill -WINCH 10576
$ sudo kill -QUIT 10576
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;とすると今までの古いnginxのワーカープロセス、マスタープロセスをkillして、新しいnginxのマスタープロセス、ワーカープロセスが稼働するようになります。&lt;/p&gt;

&lt;h1 id=&#34;confを変更:a60d664650339cdda3703b53d8a6160d&#34;&gt;confを変更&lt;/h1&gt;

&lt;p&gt;image_filterを加えます。
くわしいことは&lt;a href=&#34;http://nginx.org/en/docs/http/ngx_http_image_filter_module.html#image_filter&#34;&gt;ここ&lt;/a&gt;をみてください。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-nginx:hoge.conf&#34;&gt;location ~ /image/(.*\.png)$ {
        alias /path/to/image/$1;
            image_filter resize 100 -; # 横幅100pxでリサイズする
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;とりあえず、これで/image配下のpngファイルはリサイズされて表示されるはずです。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>